# 简答题+综合题

## 四、简答题：

### 1、使用BurpSuite对某个Web应用进行抓包，并分析其中的HTTP请求和响应头信息。写出你的分析过程和发现的安全隐患。

答案：

使用BurpSuite对Web应用进行抓包后，可以通过分析HTTP请求和响应头信息来发现安全隐患。例如，可以检查请求头中是否包含敏感信息（如Cookie），响应头中是否暴露了不必要的服务器信息。此外，还可以分析请求和响应体中的数据，查看是否存在潜在的SQL注入、跨站脚本攻击等漏洞。

·       User-Agent检查sql注入、Xss。

·       Cookie检查sql注入、Xss

·       Referrer检查sql注入、Xss

·       x-forwarded-for检查sql注入、Xss

&#x20;

### 2、描述HTTP协议的主要特点和作用。

答案：

HTTP协议的主要特点是基于请求/响应模型、无连接、无状态，使用文本格式传输数据。

它的作用是实现客户端与服务器之间的通信，通过请求和响应来传输数据和执行各种操作。

### 3、解释HTTP请求头和HTTP响应头在Web通信中的作用。

答案：

HTTP请求头包含客户端发送给服务器的附加信息，如浏览器类型、请求的资源类型等，用于服务器理解和处理请求。

·       User-Agent：产生请求的浏览器类型。

·       Accept：客户端可识别的内容类型列表。

·       Host：请求的主机名，允许多个域名同处一个IP地址，即虚拟主机。

·       Cookie: [会话状态管理](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies#%E4%BC%9A%E8%AF%9D%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86)

·       Referrer: Referer表示请求的来源

·       x-forwarded-for: 代理服务器连接到 web 服务器的客户端的原始 IP 地址的标头。

HTTP响应头包含服务器发送给客户端的附加信息，如响应的状态码、内容类型等，用于客户端理解和处理响应。

·       Location: 服务器通过这个头，来告诉浏览器跳到哪里

·       Server：服务器通过这个头，告诉浏览器服务器的型号

·       Content-Encoding：服务器通过这个头，告诉浏览器，数据的压缩格式

·       Content-Length: 服务器通过这个头，告诉浏览器回送数据的长度

·       Content-Language: 服务器通过这个头，告诉浏览器语言环境

·       Content-Type：服务器通过这个头，告诉浏览器回送数据的类型

&#x20;

### 4、假设你发现某个Web应用存在SQL注入漏洞，请描述如何利用SQL漏洞进行攻击，详细描写注入步骤（判断注入点、注入常用函数依次、获取数据说明）。

答案：

利用SQL注入漏洞进行攻击的一般步骤包括：识别注入点、构造恶意输入、执行非预期查询、获取敏感数据或执行恶意操作。防御措施包括对用户输入进行严格的验证和过滤、使用参数化查询或预编译语句、限制数据库用户的权限等。

判断注入点:单引号、双引号、sleep（）、or  and 1=1

注入常用函数依次:database()、@@datadir、version()

获取数据说明：手工注入，根据mysql系统库去查询，union联合查询或updatexml()函数，联合gropu\_concat()统计需要获取的数据。

使用sqlmap工具，  --dbs   ##显示所有数据库名称

\-D   test       #数据库名称

\-T   users    #表名称

\--dump   -D “数据库名称”   ##脱库

&#x20;

### 5、什么是XSS攻击和CSRF攻击，两者有什么区别？

答案：

概念：

XSS：是一种经常出现在Web应用程序中的安全漏洞，是由于Web应用程序对于用户的输入未过滤或过滤不足而产生的。攻击者利用Web安全漏洞把恶意的脚本代码(通常包括HTML代码或Javascript脚本)输入到网页之中，当其他用户浏览这些网页时，其中的恶意代码就会自动执行，受害用户就可能遭受到 Cookie资料窃取、会话劫持、钓鱼欺骗等各种攻击。

CSRF：跨站请求伪造。CSRF是一种劫持受信任用户向服务器发送非预期请求的攻击方式。通常情况下，CSRF攻击是攻击者借助受害者的 Cookie 骗取服务器的信任，可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击服务器，从而在并未授权的情况下执行在权限保护之下的操作。因此CSRF攻击也被称为"one click"攻击。

&#x20;

区别：

xss：跨站脚本攻击、诱骗用户点击恶意链接盗取用户 cookie 进行攻击、不需要用户进行登录、xss 除了利用 cookie 还可以篡改网页等。

csrf：跨站请求伪造、无法获取用户的cookie 而是直接冒充用户、需要用户登录后进行操作。

&#x20;

### 6、如何防止文件包含和文件上传漏洞攻击？

答案：

文件包含防御方式：

1、对用户输入的参数进行严格的审查，可以有效防止文件包含漏洞的产生

2、防止变量覆盖：应尽量避免文件包含的路径中出现用户可控制的变量。

3、定制安全的Web Service环境，检查配置文件，中间件安全配置

&#x20;

文件上传防御方式：

防御方法：

1、验证上传文件的类型。

2、限制上传文件的大小，设定合理的文件大小限制。

3、对上传的文件进行内容扫描。

4、存储文件时进行加密和权限控制：在存储文件时，应该对文件进行加密处理，并设置严格的权限控制，防止其他用户或攻击者访问和篡改服务器上的文件。同时，管理员应该定期检查服务器的日志和安全事件，及时发现和处理安全问题。

5、WAF应用防火墙设置

6、使用随机数改写文件名和文件路径（隐藏文件访问路径）。

## 五、综合题（20分）

结合如下代码案例2.php，分析该程序页面可能存在的漏洞，漏洞利用方式及防护措施。

&#x20;

答案：

SQL注入利用方式：SQL注入原理：SQL注入指的是通过把SQL命令插入到Web表单递交或输入域名或页面请求的查询字符串（参数过滤不严格），最终达到欺骗服务器执行恶意的SQL命令。

SQL注入所有种类：字符型，数字型，布尔盲注，报错注入，延迟注入，联合注入（union），堆叠，长字符截断/SQL约束攻击，二次注入，宽字节。

利用方式：手工注入（根据mysql系统库去查询，union联合查询或updatexml()函数，联合gropu\_concat()统计需要获取的数据）和sqlmap工具

防御措施：

1.对用户的参数/输入验证和过滤，特殊字符转义和过滤

2.存储过程是在数据库端预编译并执行的，用户输入的数据不直接参与构建SQL命令。

3.用户授予数据库的最小权限

4.使用web防火墙(waf)和入侵检测ids

5.预编译语句，不直接将用户输入拼接到SQL语句中。

6.安全函数addslashes()，mysql\_real\_escape\_string()，mysql\_escape\_string()

&#x20;

程序页面存在include函数，可能存在文件包含漏洞。
