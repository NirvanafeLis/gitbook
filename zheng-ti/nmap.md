# nmap

nmap的主要功能包括目标主机存活性扫描(-sn)、端口扫描（-sS或-p80,443）、操作系统信息探测(-O)、漏洞信息探测(--script==default)。

nmap如下选项具体用途（-sn，-p-，-sV，-O，-sT，-sS，-sU）

```
-sn 主机存活性扫描，类似于-sP;
-p- 全端口扫描，类似于-p1-65535
-sV 服务及版本扫描
-O 操作系统类型探测
-sT 全连接扫描（与目标建立完整三次握手）
-sS 半连接扫描
-sU UDP方式扫描
```

**然后是全新的东西（注意大小写）**

```
-PE ICMP Echo请求
-PS TCP SYN扫描
-PA TCP ACK扫描
-PB 以上的综合
-sW 滑动窗口扫描测试
-sR RPC扫描测试
```

**简述nmap探测主机存活的技术有哪些？**

**Q:** 按照扫描技术分类，Nmap的扫描可以分为TCP扫描、UDP扫描、ICMP扫描和ARP扫描等。

1. **TCP** **扫描**：TCP扫描是最常用的扫描类型之一，主要用于探测目标主机上开放的TCP端口和提供的TCP服务。TCP扫描又可以分为TCP connect()扫描和TCP SYN扫描等方法。 o **TCP connect()** **扫描**：这是最基本的TCP扫描方式，通过尝试与目标主机的每个TCP端口建立完整的三次握手连接来判断端口是否开放。 o **TCP SYN** **扫描**：SYN扫描是Nmap的默认扫描方式。它向目标主机的端口发送一个SYN数据包，并等待SYN/ACK响应。如果收到响应，则认为该端口是开放的。SYN扫描的优点是速度快且不易被检测到，因为它不会完成整个三次握手。
2. **UDP** **扫描**：UDP扫描用于探测目标主机上开放的UDP端口。由于UDP是无连接的协议，因此UDP扫描通常比TCP扫描更困难。
3. **ICMP** **扫描**：ICMP扫描主要利用ICMP协议来探测目标主机的网络连通性和可达性。
4. **ARP** **扫描**：ARP扫描是一种在本地局域网中非常有效的主机发现方法。它通过发送ARP请求来探测目标主机是否存活。ARP扫描的效率很高，但不能跨网段，且只能扫描主机存活情况，不能探测端口开放情况。 其次，按照扫描所使用的协议工作层次，Nmap的扫描可以分为二层扫描（ARP）、三层扫描（ICMP、IP）和四层扫描技术（TCP、UDP）。

/usr/share/nmap/scripts // nmap脚本存放路径\
\
至于TCP connect的全过程（三次握手）:\
一个虚拟连接的建立是通过三次握手来实现的

1. (B) --> \[SYN] --> (A)

假如服务器A和客户机B通讯. 当A要和B通信时，B首先向A发一个SYN (Synchronize) 标记的包，告诉A请求建立连接.

注意: 一个 SYN包就是仅SYN标记设为1的TCP包(参见TCP包头Resources). 认识到这点很重要，只有当A受到B发来的SYN包，才可建立连接，除此之外别无他法。因此，如果你的防火墙丢弃所有的发往外网接口的SYN包，那么你将不 能让外部任何主机主动建立连接。

2. (B) <-- \[SYN/ACK] <--(A)

接着，A收到后会发一个对SYN包的确认包(SYN/ACK)回去，表示对第一个SYN包的确认，并继续握手操作.

注意: SYN/ACK包是仅SYN 和 ACK 标记为1的包.

3. (B) --> \[ACK] --> (A)

B收到SYN/ACK 包,B发一个确认包(ACK)，通知A连接已建立。至此，三次握手完成，一个TCP连接完成

Note: ACK包就是仅ACK 标记设为1的TCP包. 需要注意的是当三此握手完成、连接建立以后，TCP连接的每个包都会设置ACK位

\
**SYN: 表示建立连接**\
**FIN: 表示关闭连接**\
**ACK: 表示响应**\
**PSH: 表示有 DATA数据传输**\
**RST: 表示连接重置。**
